<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="client.MainPage"
             Title="메인 화면">
    <ContentPage.Resources>
        <Style TargetType="Label" x:Key="CellLabel">
            <Setter Property="VerticalTextAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>

        <Style TargetType="Button" x:Key="SmallBtn">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10,8"/>
        </Style>

        <Style TargetType="Button" x:Key="CenterBtn" BasedOn="{StaticResource SmallBtn}">
            <Setter Property="FontAttributes" Value="Bold"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="Padding" Value="18,14"/>
        </Style>

        <Style TargetType="Frame" x:Key="TableFrame">
            <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}"/>
            <Setter Property="BorderColor" Value="{AppThemeBinding Light=#222222, Dark=#666666}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="HasShadow" Value="False"/>
        </Style>
    </ContentPage.Resources>

    <Grid Padding="16" RowSpacing="14" ColumnSpacing="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Frame Grid.Row="0" Style="{StaticResource TableFrame}">
            <Grid Padding="6" ColumnSpacing="1" RowSpacing="1" BackgroundColor="{AppThemeBinding Light=#CCCCCC, Dark=#444444}">
                <!-- 컬럼: [이름][수치][버튼]-->
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- 헤더 -->
                <Grid RowSpacing="1" ColumnSpacing="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                </Grid>
                
                <!-- 헤더 행-->
                <Grid Grid.Row="0" Grid.ColumnSpan="3" ColumnSpacing="1" RowSpacing="0" BackgroundColor="{AppThemeBinding Light=#EEEEEE, Dark=#333333}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <Label Grid.Column="0" Text="특성" Style="{StaticResource CellLabel}"/>
                    <Label Grid.Column="1" Text="수치" HorizontalTextAlignment="End" Style="{StaticResource CellLabel}"/>
                    <Label Grid.Column="2" Text="버튼" Style="{StaticResource CellLabel}"/>
                </Grid>
                
                <!-- 데이터 영역 -->
                <VerticalStackLayout Grid.Row="1" Spacing="1" Grid.ColumnSpan="3" BindableLayout.ItemsSource="{Binding Metrics}">
                    <BindableLayout.ItemTemplate>
                        <DataTemplate>
                            <Grid ColumnSpacing="1" BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Column="0" Text="{Binding Name}" Style="{StaticResource CellLabel}"/>
                                <Label Grid.Column="1" Text="{Binding Value}" Style="{StaticResource CellLabel}" HorizontalTextAlignment="End"/>
                                <Button Grid.Column="2" Text="상세" Style="{StaticResource SmallBtn}" 
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.OpenDetailCommand}" 
                                        CommandParameter="{Binding .}"/>
                            </Grid>
                        </DataTemplate>
                    </BindableLayout.ItemTemplate>
                </VerticalStackLayout>
            </Grid>
        </Frame>
        
        <!-- 상태창 -->
        <Frame Grid.Row="1" Style="{StaticResource TableFrame}">
            <Label Text="{Binding StatusText}" Padding="10" FontSize="16" LineBreakMode="TailTruncation"/>
        </Frame>
        
        <!-- 버튼 패드 (3*3) -->
        <Grid Grid.Row="2" Padding="4" RowSpacing="10" ColumnSpacing="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!--사이드버튼(중앙제외-->
            <Button Grid.Row="0" Grid.Column="0" Text="기능1" Style="{StaticResource SmallBtn}" Command="{Binding Func1Command}"/>
            <Button Grid.Row="0" Grid.Column="1" Text="기능2" Style="{StaticResource SmallBtn}" Command="{Binding Func2Command}"/>
            <Button Grid.Row="0" Grid.Column="2" Text="기능3" Style="{StaticResource SmallBtn}" Command="{Binding Func3Command}"/>

            <Button Grid.Row="1" Grid.Column="0" Text="기능4" Style="{StaticResource SmallBtn}" Command="{Binding Func4Command}"/>
            <Button Grid.Row="1" Grid.Column="2" Text="기능5" Style="{StaticResource SmallBtn}" Command="{Binding Func5Command}"/>

            <Button Grid.Row="2" Grid.Column="0" Text="기능6" Style="{StaticResource SmallBtn}" Command="{Binding Func6Command}"/>
            <Button Grid.Row="2" Grid.Column="1" Text="기능7" Style="{StaticResource SmallBtn}" Command="{Binding Func7Command}"/>
            <Button Grid.Row="2" Grid.Column="2" Text="기능8" Style="{StaticResource SmallBtn}" Command="{Binding Func8Command}"/>
            
            <!-- 중앙 버튼 -->
            <Button Grid.Row="1" Grid.Column="1" Text="메인 기능" Style="{StaticResource CenterBtn}" Command="{Binding MainFuncCommand}"/>

        </Grid>
    </Grid>
    
</ContentPage>
